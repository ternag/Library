# Notes on Git

A collection of observations when learning git

## Git termonology

### Local and remote repositories

Name | Description
-----|------
`master` | Is the name of the default branche when creating a new repository with `git init`
`origin` | Is the default alias of a remote repository, created when cloning a repository with `git clone <url>`. Use `git remote` to list known aliases and `git remote -v` to also list the url of the remote repository. Can be renamed with `git remote rename ...`
`origin\master` | Is the reference to the master branch on the remote repository with the alias origin.
`remote repository` | A git repository on another machine, identified by a url (for which there usually is an alias).
`tracking` | 
`upstream` | 
`staged files` | [todo]
Hash | Every commit is SHA-1 hashed. <br/> `git log` shows the whole hash, where as `git log --oneline` only show the first 7 digits. Usually the first 7 digits of the hash is enough to identify a specific commit. Git commands, like `git cherry-pick`, that operates on whole commits, uses the hash to identify the individual commits. 

## Git Help

To get help on a git command add the *--help* option. F.ex:

    git --help
    git checkout --help
    git remote update --help

## Git - Howto's

**[Table of Contents](http://tableofcontent.eu)**
<!-- Table of contents generated generated by http://tableofcontent.eu -->

- [How do I check if a *git pull* is needed on current branch](#how-do-i-check-if-a-git-pull-is-needed-on-current-branch)
- [How do I switch branch?](#how-do-i-switch-branch)
- [How do I discard (undo) unstaged file(s)?](#how-do-i-discard-undo-unstaged-files)
- [How do I remove untracked files?](#how-do-i-remove-untracked-files)
- [How do I view remote references?](#how-do-i-view-remote-references)
- [How do I rename a local branch which hasn't been pushed to a remote branch?](#how-do-i-rename-a-local-branch-which-hasnt-been-pushed-to-a-remote-branch)
- [When would I do a pull with rebase? and why?](#when-would-i-do-a-pull-with-rebase-and-why)
- [How can I see the branch graph in the console?](#how-can-i-see-the-branch-graph-in-the-console)
- [How can I use aliases in git?](#how-can-i-use-aliases-in-git)
- [How do I merge two branches](#how-do-i-merge-two-branches)
- [How do I handle merge conflicts from the commandline?](#how-do-i-handle-merge-conflicts-from-the-commandline)
- [How to configure Beyond Compare 4 as the default merge tool](#how-to-configure-beyond-compare-4-as-the-default-merge-tool)
- [How do I undo last commit?](#how-do-i-undo-last-commit)
- [How do I delete a branch?](#how-do-i-delete-a-branch)
- [How do I push a local branch to remote the first time?](#how-do-i-push-a-local-branch-to-remote-the-first-time)
- [How do I create a new local branch based on another local branch?](#how-do-i-create-a-new-local-branch-based-on-another-local-branch)
- [How do I move latest commit from one branch to a new branch?](#how-do-i-move-latest-commit-from-one-branch-to-a-new-branch)


## How do I check if a *git pull* is needed on current branch

First use `git remote update`, to bring your remote refs up to date.

1. `git status -uno` will tell you whether the branch you are tracking is ahead, behind or has diverged. If it says nothing, the local and remote are the same.

1. `git show-branch *master` will show you the commits in all of the branches whose names end in 'master' (eg master and origin/master).

## How do I switch branch?

    git checkout <branch name>

## How do I list available branches?

    git branch

Default list known local branches

    git branch -r

List remote branches

    git branch -a

List all available branches

## How do I discard (undo) unstaged file(s)?

Discard specific unstaged file:

    git checkout -- <path-to-file>

Discard all unstaged files:

    git checkout -- .

## How do I remove untracked files?

Use `git status` to list staged, unstaged and untracked files. 

Remove untracked files. **Be carefull this will delete files**:

Step 1. Show what will be deleted without actually deleting anything:

    git clean -n

Step 2. If step 1 shows the expected files then use:

    git clean -f

to remove files. Use

    git clean -f -d

to also remove untracked diretories.

## How do I view remote references?

    git remote

## How do I rename a local branch which hasn't been pushed to a remote branch?

If you want to rename a branch while pointed to any branch, do:

    git branch -m <oldname> <newname>

If you want to rename the current branch, you can do:

    git branch -m <newname>

A way to remember this, is -m is for "move" (or mv), which is how you rename files.

## When would I do a pull with rebase? and why?

If you have commits in your local repository, and the remote repository have commits which you have not pulled, and your changes do not deserve a separate branch.

    git pull --rebase

## How can I see the branch graph in the console?

    git log --graph --oneline --decorate

Add --max-count \<n\> to limit the length.

## How can I use aliases in git?

To create git alias in ~/.gitconfig, add the following:

    [Alias]
      lol = log --graph --oneline --decorate

To use your alias do: 

    git lol

Add --max-count \<n\> to limit the output:

    git lol --max-count 40

Or add an extra alias to the ~/.gitconfit file:

    [Alias]
      lol = log --graph --oneline --decorate
      lol4 = log --graph --oneline --decorate --max-count 40

## How do I merge two branches

You use

    git merge <branch-name>

The right mindset is important here. Your current<sup>*)</sup> branch is the target of the merge and the `<branch-name>` is the source branch. So `<branch-name>` will be merged into your current branch.

<sup>*)</sup> Use `git branch` to see branches. Starred branch is your current branch.

## How do I handle merge conflicts from the commandline?

Use git merge tool

    git mergetool

This starts a flow where each file with merge conflicts is handled in turn.

## How to configure Beyond Compare 4 as the default merge tool

This congifures beyond compare 4 as the default merge tool for all your git repostiories. Use the `--local` switch to only configure it for the current git repository.

    git config --global merge.tool=bc3
    git config --global mergetool.bc3.path=c:/Program Files/Beyond Compare 4/bcomp.exe

## How do I undo last commit?

If want to get rid of the last commit on your local branch just reset the HEAD to the commit before. Files from the last commit will now appear as changed files when doing `git status`

    git reset HEAD~1

## How do I delete a branch?

A local branch can be deleted this way:

    git branch --delete <branch-name>

A remote branch can be deleted using the push command:

    git push origin --delete <branch-name>

'origin' being the alias for the remote repository

## How do I push a local branch to remote the first time?

You push your branch and also set up tracking of the branch.

    git push --set-upstream origin <branch-name>

'origin' being the alias for the remote repository

## How do I stop tracking a remote branch?

    git branch --unset-upstream

## How do I create a new local branch based on another local branch?

Use `git branch` command to create new branch and `git checkout` to switch to it:

    git checkout <base-branch-name> # switch to base branch
                                    # Make sure it is up to date (`git status` and maybe `git pull` if needed).
    git branch <new-branch-name>    # create new branch based on current branch
    git checkout <new-branch-name>  # switch to new branch

You can also use `git checkout` (with the -b flag) to "create branch and switch to is" in one command.

    git checkout <base-branch-name>   # switch to base branch 
                                      # Make sure it is up to date (`git status` and maybe `git pull` if needed).
    git checkout -b <new-branch-name> # create new branch and switch to it

## How do I move latest commit from one branch to a new branch?

By cherry-picking it in the new branch. First create the new branch from a suitable point and switch to it. Then cherry-pick the desired commit by providing its hash value. Use `git log --max-count <n>` to view the hash of your commit. (`--max-count <n>` list the lastest <n> commit on your current branch)

    git checkout -b <new-branch-name>
    git cherry-pick 23bf664

A range can also be used with cherry-pick like this:

    git checkout -b <new-branch-name>
    git cherry-pick 88de454..23bf664

## How do I clean up local branches after a successful pull-request.

So, you want to remove local worker branches which has successfully been merged to a main branch. Use `git remote prune`

To see what will be pruned use:

    git remote prune origin --dry-run

To actually do it, remove "--dry-run"

## How do I see a branch's commit history?

`git log` will list commit history for your current branch.

    git log
    git log --oneline         # Each commit is one-line
    git log -2                # list the two latest commits

## What is the difference between 'git remote update', 'git fetch' and 'git pull'?

`git remote update` will update all of your branches set to track remote ones, but not merge any changes in.

`git fetch` will update only the branch you're on, but not merge any changes in.

`git pull` will update and merge any remote changes of the current branch you're on. This would be the one you use to update a local branch.
